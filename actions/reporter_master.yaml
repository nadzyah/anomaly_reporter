---
name: reporter_master
pack: anomaly_reporter
description: An anomaly reporter workflow that runs reporter in a loop
runner_type: orquesta
entry_point: workflows/reporter_master.yaml
enabled: true
parameters:
  clients_emails_and_hosts:
    type: object
    description: 'The dictionary of clients and collections with hosts that are accosiated
        with each client in the next format: {"client1":{"emails":["client1-1@example.com","cleint1-2@example.com"],"cols_and_hosts":{"web_anomaly":["dataform"],"network_anomaly":["cumulus"]}},"\u0441lient2":{"emails":["client2-1@example2.com","cleint2-2@example2.com"],"cols_and_hosts":{"utm_anomaly":["172.17.18.56"],"network_anomaly":["cumulus"]}}}'
    required: true
    default: "{{ config_context.clients_emails_and_hosts }}"
    position: 1
  mongouri:
    type: string
    description: MongoDB URI in "mongodb://username:password@X.X.X.X:yyyy" format
    required: true
    default: "{{ config_context.mongouri }}"
    position: 2
  sourcedb:
    type: string
    description: Name of the database, where anomaly logs are stored
    required: true
    default: "{{ config_context.sourcedb }}"
    position: 3
  event_handler_period:
    type: integer
    description: Event collection period in days
    required: true
    default: "{{ config_context.event_handler_period }}"
    position: 4
  report_store_dir:
    type: string
    description: Base directory, where reports will be stored
    required: true
    default: "{{ config_context.report_store_dir }}"
    position: 5
  smtp_servername:
    type: string
    description: "The mail server FQDN"
    required: true
    default: "{{ config_context.smtp_servername }}"
    position: 6
  smtp_server_port:
    type: integer
    description: "The mail server smtp_server_port"
    required: true
    default: "{{ config_context.smtp_server_port }}"
    position: 7
  use_ssl:
    type: boolean
    description: "True if SSL/TLS (now STARTTLS) encryption should be used"
    required: true
    default: "{{ config_context.use_ssl }}"
    position: 8
  use_starttls:
    type: boolean
    description: "True if STARTTLS should be used"
    required: true
    default: "{{ config_context.use_starttls }}"
    position: 9
  sender:
    type: string
    description: "The email address of the server"
    required: true
    default: "{{ config_context.sender }}"
    position: 10
  sender_username:
    type: string
    description: "The sender username for SMTP authentication"
    required: true
    default: "{{ config_context.sender_username }}"
    position: 11
  sender_password:
    type: string
    description: "The sender password for SMTP authentication"
    required: true
    default: "{{ config_context.sender_password }}"
    position: 12
